#########################################################
CREATE VIEW vwMtBr
AS
SELECT vwmt.[mtGUID]
      ,vwmt.[mtNumber]
      ,vwmt.[mtName]
      ,vwmt.[mtCode]
      ,vwmt.[mtLatinName]
      ,vwmt.[mtBarCode]
      ,vwmt.[mtCodedCode]
      ,vwmt.[mtGroup]
      ,vwmt.[mtUnity]
      ,vwmt.[mtSpec]
      ,vwmt.[mtQty]
      ,vwmt.[mtHigh]
      ,vwmt.[mtLow]
      ,vwmt.[mtOrder]
      ,vwmt.[mtWhole]
      ,vwmt.[mtHalf]
      ,vwmt.[mtVendor]
      ,vwmt.[mtExport]
      ,vwmt.[mtRetail]
      ,vwmt.[mtEndUser]
      ,vwmt.[mtMaxPrice]
      ,vwmt.[mtAvgPrice]
      ,vwmt.[mtLastPrice]
      ,vwmt.[mtWhole2]
      ,vwmt.[mtHalf2]
      ,vwmt.[mtVendor2]
      ,vwmt.[mtExport2]
      ,vwmt.[mtRetail2]
      ,vwmt.[mtEndUser2]
      ,vwmt.[mtMaxPrice2]
      ,vwmt.[mtLastPrice2]
      ,vwmt.[mtWhole3]
      ,vwmt.[mtHalf3]
      ,vwmt.[mtVendor3]
      ,vwmt.[mtExport3]
      ,vwmt.[mtRetail3]
      ,vwmt.[mtEndUser3]
      ,vwmt.[mtMaxPrice3]
      ,vwmt.[mtLastPrice3]
      ,vwmt.[mtPriceType]
      ,vwmt.[mtSellType]
      ,vwmt.[mtBonusOne]
      ,vwmt.[mtPicture]
      ,vwmt.[mtCurrencyVal]
      ,vwmt.[mtCurrencyPtr]
      ,vwmt.[mtUseFlag]
      ,vwmt.[mtOrigin]
      ,vwmt.[mtCompany]
      ,vwmt.[mtType]
      ,vwmt.[mtSecurity]
      ,vwmt.[mtLastPriceDate]
      ,vwmt.[mtBonus]
      ,vwmt.[mtUnit2]
      ,vwmt.[mtUnit2Fact]
      ,vwmt.[mtUnit3]
      ,vwmt.[mtUnit3Fact]
      ,vwmt.[mtFlag]
      ,vwmt.[mtPos]
      ,vwmt.[mtDim]
      ,vwmt.[mtDefUnitFact]
      ,vwmt.[mtDefUnitName]
      ,vwmt.[mtDefUnit]
      ,vwmt.[mtExpireFlag]
      ,vwmt.[mtProductionFlag]
      ,vwmt.[mtUnit2FactFlag]
      ,vwmt.[mtUnit3FactFlag]
      ,vwmt.[mtBarCode2]
      ,vwmt.[mtBarCode3]
      ,vwmt.[mtSNFlag]
      ,vwmt.[mtForceInSN]
      ,vwmt.[mtForceOutSN]
      ,vwmt.[mtVat]
      ,vwmt.[mtColor]
      ,vwmt.[mtProvenance]
      ,vwmt.[mtQuality]
      ,vwmt.[mtModel]
      ,vwmt.[brBranchMask] mtBranchMask
      ,vwmt.[IsIntegerQuantity],
	   vwbr.*
	   FROM
vwmt inner join vwbr ON (POWER(2, vwbr.brNumber-1) &  vwmt.brBranchMask) >0
#########################################################
#END