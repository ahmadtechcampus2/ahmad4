#########################################################
CREATE FUNCTION fnFindMaterialEquivalents

(@matGuid as UNIQUEIDENTIFIER) 
RETURNS @Result TABLE(
				Number				INT,
				Name				NVARCHAR(250),
				Code				NVARCHAR(100),	
				LatinName			NVARCHAR(250),
				BarCode				NVARCHAR(250),
				CodedCode			NVARCHAR(250),
				Unity				NVARCHAR(100),
				Spec				NVARCHAR(1000),
				Qty					FLOAT,
				High				FLOAT,
				Low					FLOAT,
				Whole				FLOAT,
				Half				FLOAT,
				Retail				FLOAT,
				Enduser				FLOAT,
				Export				FLOAT,
				Vendor				FLOAT,
				Maxprice			FLOAT,
				Avgprice			FLOAT,
				LastPrice			FLOAT,
				PriceType			INT,
				SellType			INT,
				BonusOne			FLOAT,
				CurrencyVal			FLOAT,
				UseFlag				FLOAT,
				Origin				NVARCHAR(250),
				Company				NVARCHAR(250),
				Type				INT,
				Security			INT,
				LastPriceDate		DATETIME,
				Bonus				FLOAT,
				Unit2				NVARCHAR(100),
				Unit2Fact			FLOAT,
				Unit3				NVARCHAR(100),
				Unit3Fact			FLOAT,
				Flag				FLOAT,
				Pos					NVARCHAR(250),
				Dim					NVARCHAR(250),
				ExpireFlag			BIT,
				ProductionFlag		BIT,
				Unit2FactFlag		BIT,
				Unit3FactFlag		BIT,
				BarCode2			NVARCHAR(250),
				BarCode3			NVARCHAR(250),
				SNFlag				BIT,
				ForceInSN			BIT,
				ForceOutSN			BIT,
				VAT					FLOAT,
				Color				NVARCHAR(250),
				Provenance			NVARCHAR(250),
				Quality				NVARCHAR(250),
				Model				NVARCHAR(250),
				Whole2				FLOAT,
				Half2				FLOAT,
				Retail2				FLOAT,
				Enduser2			FLOAT,
				Export2				FLOAT,
				Vendor2				FLOAT,
				MaxPrice2			FLOAT,
				LastPrice2			FLOAT,
				Whole3				FLOAT,
				Half3				FLOAT,
				Retail3				FLOAT,
				Enduser3			FLOAT,
				Export3				FLOAT,
				Vendor3				FLOAT,
				MaxPrice3			FLOAT,
				LastPrice3			FLOAT,
				GUID				UNIQUEIDENTIFIER,
				GroupGUID			UNIQUEIDENTIFIER,
				PictureGUID			UNIQUEIDENTIFIER,
				CurrencyGUID		UNIQUEIDENTIFIER,
				DefUnit				INT,
				Bhide				BIT,
				BranchMask			BIGINT,
				OldGUID				UNIQUEIDENTIFIER,
				NewGUID				UNIQUEIDENTIFIER,
				Assemble			BIT,
				OrderLimit			FLOAT,
				CalPriceFromDetail	BIT,
				ForceInExpire		BIT,
				ForceOutExpire		BIT,
				CreateDate			DATETIME,
				IsIntegerQuantity	BIT,
				grCode				NVARCHAR(100),
				grName				NVARCHAR(250),
				grLatinName			NVARCHAR(250),
				Qty0				FLOAT) 

BEGIN
	INSERT INTO @Result 
	SELECT DISTINCT 
				vdmt2.[Number]			AS Number,
				vdmt2.[Name]			AS Name,
				vdmt2.[Code]			AS Code,
				vdmt2.[LatinName]		AS LatinName,
				[BarCode]				AS BarCode,
				[CodedCode]				AS CodedCode,
				[Unity]					AS Unity,
				[Spec]					AS Spec,
				vdmt2.[Qty]				AS Qty,
				[High]					AS High,
				[Low]					AS Low,
				[Whole]					AS Whole,
				[Half]					AS Half,
				[Retail]				AS Retail,
				[EndUser]				AS EndUser,
				[Export]				AS Export,
				[Vendor]				AS Vendor,
				[MaxPrice]				AS MaxPrice,
				[AvgPrice]				AS AvgPrice,
				[LastPrice]				AS LastPrice,
				[PriceType]				AS PriceType,
				[SellType]				AS SellType,
				[BonusOne]				AS BonusOne,
				[CurrencyVal]			AS CurrencyVal,
				[UseFlag]				AS UseFlag,
				[Origin]				AS Origin,
				[Company]				AS Company,
				[Type]					AS Type,
				[Security]				AS Security,
				[LastPriceDate]			AS LastPriceDate,
				[Bonus]					AS Bonus,
				[Unit2]					AS Unit2,
				[Unit2Fact]				AS Unit2Fact,
				[Unit3]					AS Unit3,
				[Unit3Fact]				AS Unit3Fact,
				[Flag]					AS Flag,
				[Pos]					AS Pos,
				[Dim]					AS Dim,
				[ExpireFlag]			AS ExpireFlag,
				[ProductionFlag]		AS ProductionFlag,
				[Unit2FactFlag]			AS Unit2FactFlag,
				[Unit3FactFlag]			AS Unit3FactFlag,
				[BarCode2]				AS BarCode2,
				[BarCode3]				AS BarCode3,
				[SNFlag]				AS SNFlag,
				[ForceInSN]				AS ForceInSN,
				[ForceOutSN]			AS ForceOutSN,
				[VAT]					AS VAT,
				[Color]					AS Color,
				[Provenance]			AS Provenance,
				[Quality]				AS Quality,
				[Model]					AS Model,
				[Whole2]				AS Whole2,
				[Half2]					AS Half2,
				[Retail2]				AS Retail2,
				[EndUser]				AS Enduser,
				[Export2]				AS Export2,
				[Vendor2]				AS Vendor2,
				[MaxPrice2]				AS MaxPrice2,
				[LastPrice2]			AS LastPrice2,
				[Whole3]				AS Whole3,
				[Half3]					AS Half3,
				[Retail3]				AS Retail3,
				[EndUser3]				AS Enduser3,
				[Export3]				AS Export3,
				[Vendor3]				AS Vendor3,
				[MaxPrice3]				AS MaxPrice3,
				[LastPrice3]			AS LastPrice3,
				mev.[equivalentguid]	AS GUID,
				[GroupGUID]				AS GroupGuid,
				[PictureGUID]			AS PictureGuid,
				[CurrencyGUID]			AS CurrencyGuid,
				[DefUnit]				AS DefUnit,
				[bHide]					AS bHide,
				[branchMask]			AS branchMask,
				[OldGUID]				AS OldGUID,
				[NewGUID]				AS NewGUID,
				[Assemble]				AS Assemble,
				[OrderLimit]			AS OrderLimit,
				[calpricefromdetail]	AS CalPriceFromDetail,
				[ForceInExpire]			AS ForceInExpire,
				[ForceOutExpire]		AS ForceOutExpire,
				[CreateDate]			AS CreateDate,
				[IsIntegerQuantity]		AS IsIntegerQuantity,
				[grCode]				AS grCode,
				[grName]				AS grName,
				[grLatinName]			AS grLatinName,
				[Qty0]					AS Qty0
					
	FROM vwMatEquivalents AS mev
	INNER JOIN vdmt2 ON vdmt2.GUID = mev.equivalentguid
	WHERE 
		 matguid = @matGuid 

	RETURN
END
#########################################################
#END