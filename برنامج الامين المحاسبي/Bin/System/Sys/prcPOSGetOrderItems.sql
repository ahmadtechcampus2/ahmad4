################################################################################
CREATE PROC prcPOSGetOrderItems
	@OrderNumber	FLOAT,
	@ItemType		INT
AS
SET NOCOUNT ON

	SELECT 
		[ord].[Type] AS [OrderType],
		[ord].[Number] AS [OrderNumber],
		[ord].[Serial] AS [OrderSerial],
		[ord].[ID] AS [OrderID],
		[ord].[CashierID] AS [OrderCashierID],
		[ord].[FinishCashierID] AS [OrderFinishCashierID],
		[ord].[BranchID] AS [OrderBranchID],
		[ord].[State] AS [OrderState],
		[ord].[Date] AS [OrderDate],
		[ord].[Notes] AS [OrderNotes],
		[ord].[Payment] AS [OrderPayment],
		[ord].[Cashed] AS [OrderCashed],
		[ord].[Discount] AS [OrderDiscount],
		[ord].[Added] AS [OrderAdded],
		[ord].[Tax] AS [OrderTax],
		[ord].[TotalDiscount] AS [OrderTotalDiscount],
		[ord].[TotalAdded] AS [OrderTotalAdded],
		[ord].[TotalTax] AS [OrderTotalTax],
		[ord].[SubTotal] AS [OrderSubTotal],
		[ord].[CustomerID] AS [OrderCustomerID],
		[ord].[CustomerName] AS [OrderCustomerName],
		[ord].[CustomerNumber] AS [OrderCustomerNumber], 
		[ord].[DeferredAccountID] AS [OrderDeferredAccountID],
		[ord].[CurrencyID] AS [OrderCurrencyID],
		[ord].[CurrencyCode] AS [OrderCurrencyCode],
		[ord].[CurrencyName] AS [OrderCurrencyName],
		[ord].[CurrencyVal] AS [OrderCurrencyVal],
		[ord].[IsPrinted] AS [OrderIsPrinted],
		[ord].[HostName] AS [OrderHostName],
		[ord].[BillNumber] AS [OrderBillNumber],
		[oi].[ItemNumber] AS [ItemNumber],
		[oi].[ItemID] AS [ItemID],
		[oi].[MatID] AS [ItemMatID],
		[oi].[Type] AS [ItemType],
		[oi].[Qty] AS [ItemQty],
		[oi].[MatPrice] AS [ItemMatPrice],
		[oi].[VATValue] AS [ItemVATValue],
		[oi].[Price] AS [ItemPrice],
		[oi].[PriceType] AS [ItemPriceType],
		[oi].[Unity] AS [ItemUnity],
		[oi].[QtyByDefUnit] AS [ItemQtyByDefUnit],
		[oi].[UnitName] AS [ItemUnitName],
		[oi].[UnitFactory] AS [ItemUnitFactory],
		[oi].[State] AS [ItemState],
		[oi].[Discount] AS [ItemDiscount],
		[oi].[DiscountPercent] AS [ItemDiscountPercent],
		[oi].[Added] AS [ItemAdded],
		[oi].[AddedPercent] AS [ItemAddedPercent],
		[oi].[Tax] AS [ItemTax],
		[oi].[TaxPercent] AS [ItemTaxPercent],
		[oi].[SubTotal] AS [ItemSubTotal],
		[oi].[Total] AS [ItemTotal],
		[oi].[ParentID] AS [ItemParentID],
		[oi].[ItemParentID] AS [ItemItemParentID],
		[oi].[SalesmanID] AS [ItemSalesmanID],
		[oi].[PrinterID] AS [ItemPrinterID],
		[oi].[ExpirationDate] AS [ItemExpirationDate],
		[oi].[ProductionDate] AS [ItemProductionDate],
		[oi].[AccountID] AS [ItemAccountID],
		[oi].[BillType] AS [ItemBillType],
		[oi].[Note] AS [ItemNote],
		[oi].[SpecialOfferID] AS [ItemSpecialOfferID],
		[oi].[SpecialOfferIndex] AS [ItemSpecialOfferIndex],
		[oi].[OfferedItem] AS [ItemOfferedItem],
		[oi].[IsPrinted] AS [ItemIsPrinted],
		[oi].[SerialNumber] AS [ItemSerialNumber],
		[oi].[MatCode] AS [ItemMatCode],
		[oi].[MatName] AS [ItemMatName],
		[oi].[MatLatinName] AS [ItemMatLatinName],
		[oi].[Barcode] AS [ItemBarcode],
		[oi].[Barcode2] AS [ItemBarcode2],
		[oi].[Barcode3] AS [ItemBarcode3],
		[oi].[GRGuid] AS [ItemGRGuid],
		[oi].[GRCode] AS [ItemGRCode],
		[oi].[GRName] AS [ItemGRName],
		[oi].[SMCode] AS [ItemSMCode],
		[oi].[SMName] AS [ItemSMName],
		[oi].[BTName] AS [ItemBTName],
		[oi].[VatSys] AS [ItemVatSys],
		[oi].[VatName] AS [ItemVatName]
				
	FROM vwPOSOrderItems AS oi 
		inner join vwPOSOrder AS ord ON oi.ParentID = ord.id
	WHERE	(ord.Number = @OrderNumber)
	AND 	(oi.Type = @ItemType)
################################################################################
#END
